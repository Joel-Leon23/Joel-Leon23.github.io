<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Problema de la Mochila</title>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container">
    <h1>Problema de la Mochila</h1>
    <form id="knapSackForm">
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="capacity">Capacidad</label>
          <input type="number" id="capacity" class="form-control">
        </div>
        <div class="form-group col-md-6">
          <button type="button" id="addItem" class="btn btn-primary btn-block mt-4">AÃ±adir Item</button>
        </div>
      </div>
      <div id="itemContainer"></div>
      <button type="submit" class="btn btn-success btn-block mt-4">Calcular</button>
    </form>
    <h2 id="totalValue"></h2>
    <h2 id="totalWeight"></h2>
    <table id="selectedItems" class="table">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Valor</th>
          <th scope="col">Peso</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>
  <script>
    let selectedItems = [];
    function max(a, b, n) {
      return (a > b) ? {value: a , item: n} : b;
    }
    function knapSack(W, wt, val, n) {
      if (n <= 0 || W <= 0) {
        return 0;
      }
      if (wt[n - 1] > W) {
        return knapSack(W, wt, val, n - 1);
      }   
      const result = max(val[n - 1] + knapSack(W - wt[n - 1], wt, val, n - 1), knapSack(W, wt, val, n - 1), n - 1);
      if (result instanceof Object) {
        selectedItems.push(result.item);
        return result.value;
      }
      return result;
    }
    document.getElementById('addItem').addEventListener('click', () => {
      const itemContainer = document.getElementById('itemContainer');
      const newItem = document.createElement('div');
      newItem.className = 'form-row item';
      newItem.innerHTML = `
        <div class="form-group col-md-6">
          <label for="value">Valor</label>
          <input type="number" class="form-control value">
        </div>
        <div class="form-group col-md-6">
          <label for="weight">Peso</label>
          <input type="number" class="form-control weight">
        </div>
      `;
      itemContainer.appendChild(newItem);
    });
    
    document.getElementById('knapSackForm').addEventListener('submit', (e) => {
      e.preventDefault();
      selectedItems = [];
      const capacity = Number(document.getElementById('capacity').value);
      const values = Array.from(document.getElementsByClassName('value')).map(x => Number(x.value));
      const weights = Array.from(document.getElementsByClassName('weight')).map(x => Number(x.value));
      const totalValue = knapSack(capacity, weights, values, values.length);
      console.log(selectedItems)
      console.log(totalValue)
      document.getElementById('totalValue').innerText = 'Valor total: ' + totalValue;
    });
    
  </script>
</body>
</html>
